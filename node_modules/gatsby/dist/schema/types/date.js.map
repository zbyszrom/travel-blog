{"version":3,"sources":["../../../src/schema/types/date.js"],"names":["moment","require","GraphQLString","GraphQLBoolean","GraphQLScalarType","Kind","oneLine","ISO_8601_FORMAT","GraphQLDate","name","description","serialize","String","parseValue","parseLiteral","ast","kind","STRING","value","undefined","isDate","momentDate","utc","isValid","formatDate","date","fromNow","difference","formatString","locale","normalizedDate","JSON","parse","stringify","format","diff","dateResolver","type","args","resolve","source","context","fieldName","Array","isArray","map","d","module","exports"],"mappings":"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","sourcesContent":["const moment = require(`moment`)\nconst {\n  GraphQLString,\n  GraphQLBoolean,\n  GraphQLScalarType,\n  Kind,\n} = require(`graphql`)\nconst { oneLine } = require(`common-tags`)\n\nconst ISO_8601_FORMAT = [\n  `YYYY`,\n  `YYYY-MM`,\n  `YYYY-MM-DD`,\n  `YYYYMMDD`,\n\n  // Local Time\n  `YYYY-MM-DDTHH`,\n  `YYYY-MM-DDTHH:mm`,\n  `YYYY-MM-DDTHHmm`,\n  `YYYY-MM-DDTHH:mm:ss`,\n  `YYYY-MM-DDTHHmmss`,\n  `YYYY-MM-DDTHH:mm:ss.SSS`,\n  `YYYY-MM-DDTHHmmss.SSS`,\n\n  // Coordinated Universal Time (UTC)\n  `YYYY-MM-DDTHHZ`,\n  `YYYY-MM-DDTHH:mmZ`,\n  `YYYY-MM-DDTHHmmZ`,\n  `YYYY-MM-DDTHH:mm:ssZ`,\n  `YYYY-MM-DDTHHmmssZ`,\n  `YYYY-MM-DDTHH:mm:ss.SSSZ`,\n  `YYYY-MM-DDTHHmmss.SSSZ`,\n\n  `YYYY-[W]WW`,\n  `YYYY[W]WW`,\n  `YYYY-[W]WW-E`,\n  `YYYY[W]WWE`,\n  `YYYY-DDDD`,\n  `YYYYDDDD`,\n]\n\nconst GraphQLDate = new GraphQLScalarType({\n  name: `Date`,\n  description: oneLine`\n    A date string, such as 2007-12-03, compliant with the ISO 8601 standard\n    for representation of dates and times using the Gregorian calendar.`,\n  serialize: String,\n  parseValue: String,\n  parseLiteral(ast) {\n    return ast.kind === Kind.STRING ? ast.value : undefined\n  },\n})\n\n// Check if this is a date.\n// All the allowed ISO 8601 date-time formats used.\nfunction isDate(value) {\n  const momentDate = moment.utc(value, ISO_8601_FORMAT, true)\n  return momentDate.isValid() && typeof value !== `number`\n}\n\nconst formatDate = ({\n  date,\n  fromNow,\n  difference,\n  formatString,\n  locale = `en`,\n}) => {\n  const normalizedDate = JSON.parse(JSON.stringify(date))\n  if (formatString) {\n    return moment\n      .utc(normalizedDate, ISO_8601_FORMAT, true)\n      .locale(locale)\n      .format(formatString)\n  } else if (fromNow) {\n    return moment\n      .utc(normalizedDate, ISO_8601_FORMAT, true)\n      .locale(locale)\n      .fromNow()\n  } else if (difference) {\n    return moment().diff(\n      moment.utc(normalizedDate, ISO_8601_FORMAT, true).locale(locale),\n      difference\n    )\n  }\n  return normalizedDate\n}\n\nconst dateResolver = {\n  type: `Date`,\n  args: {\n    formatString: {\n      type: GraphQLString,\n      description: oneLine`\n        Format the date using Moment.js' date tokens, e.g.\n        \\`date(formatString: \"YYYY MMMM DD\")\\`.\n        See https://momentjs.com/docs/#/displaying/format/\n        for documentation for different tokens.`,\n    },\n    fromNow: {\n      type: GraphQLBoolean,\n      description: oneLine`\n        Returns a string generated with Moment.js' \\`fromNow\\` function`,\n    },\n    difference: {\n      type: GraphQLString,\n      description: oneLine`\n        Returns the difference between this date and the current time.\n        Defaults to \"miliseconds\" but you can also pass in as the\n        measurement \"years\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\",\n        and \"seconds\".`,\n    },\n    locale: {\n      type: GraphQLString,\n      description: oneLine`\n        Configures the locale Moment.js will use to format the date.`,\n    },\n  },\n  resolve(source, args, context, { fieldName }) {\n    const date = source[fieldName]\n    if (date == null) return null\n\n    return Array.isArray(date)\n      ? date.map(d => formatDate({ date: d, ...args }))\n      : formatDate({ date, ...args })\n  },\n}\n\nmodule.exports = { GraphQLDate, dateResolver, isDate }\n"],"file":"date.js"}